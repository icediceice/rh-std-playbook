# Central rsyslog server configuration for {{ server_hostname }}
# Environment: {{ server_environment }}

# Provides TCP syslog reception
module(load="imtcp")
input(type="imtcp" port="514")

# Provides UDP syslog reception
module(load="imudp")
input(type="imudp" port="514")

# Template for remote logs
$template RemoteLogs,"/var/log/remote/%HOSTNAME%/%PROGRAMNAME%.log"
*.* ?RemoteLogs

# Rules for organizing logs
if $programname == 'httpd' then /var/log/remote/applications/httpd.log
if $programname == 'mysqld' then /var/log/remote/applications/mysql.log
if $programname == 'sshd' then /var/log/remote/security/sshd.log
if $syslogfacility-text == 'authpriv' then /var/log/remote/security/authpriv.log
if $syslogfacility-text == 'kern' then /var/log/remote/kernel.log

# Stop processing after storing
& stop

# Include standard rsyslog configuration
$IncludeConfig /etc/rsyslog.d/*.conf