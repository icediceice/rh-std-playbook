# Elasticsearch configuration for {{ server_hostname }}
# Environment: {{ server_environment }}

cluster.name: logging-cluster-{{ server_environment }}
node.name: {{ server_hostname }}

path.data: /var/lib/elasticsearch
path.logs: /var/log/elasticsearch

network.host: {{ ansible_default_ipv4.address }}
http.port: {{ elasticsearch_port }}

discovery.seed_hosts: ["{{ ansible_default_ipv4.address }}"]
cluster.initial_master_nodes: ["{{ server_hostname }}"]

# Memory settings
bootstrap.memory_lock: true

# Security settings for production
{% if server_environment == 'production' %}
xpack.security.enabled: true
xpack.security.transport.ssl.enabled: true
xpack.security.transport.ssl.verification_mode: certificate
xpack.security.transport.ssl.keystore.path: certs/elastic-certificates.p12
xpack.security.transport.ssl.truststore.path: certs/elastic-certificates.p12
{% endif %}

# Performance settings
indices.memory.index_buffer_size: 30%
thread_pool.write.queue_size: 1000

# Logging settings
logger.level: {{ 'INFO' if server_environment == 'production' else 'DEBUG' }}